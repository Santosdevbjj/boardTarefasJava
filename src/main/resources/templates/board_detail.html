<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title th:text="'Board - ' + ${board.name}">Board Detalhes</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="container py-4">

    <h1 th:text="${board.name}">Nome do Board</h1>

    <a th:href="@{/boards}" class="btn btn-secondary mb-3">Voltar</a>

    <h3>Colunas</h3>
    <a th:href="@{/boards/{boardId}/columns/new(boardId=${board.id})}" class="btn btn-primary mb-3">Adicionar Coluna</a>

    <div class="row">
        <div class="col-md-4" th:each="column : ${board.columns}">
            <div class="card mb-4">
                <div class="card-header">
                    <h5 th:text="${column.name}">Nome da Coluna</h5>
                </div>
                <div class="card-body">
                    

                    <li class="list-group-item" th:each="task : ${column.tasks}">
    <strong th:text="${task.title}">Título da Task</strong><br>
    <small th:text="${task.description}">Descrição da Task</small><br>
    <small>Status: <span th:text="${task.status}"></span></small><br>
    <a th:href="@{/boards/tasks/{taskId}/move(taskId=${task.id})}" class="btn btn-sm btn-warning mt-2">Mover</a>
</li>




                <li class="list-group-item" th:each="task : ${column.tasks}">
    <strong th:text="${task.title}">Título da Task</strong><br>
    <small th:text="${task.description}">Descrição da Task</small><br>
    <small>Status: <span th:text="${task.status}"></span></small>
    <div class="mt-2">
        <!-- botão mover já existente -->
        <a th:href="@{/boards/tasks/{taskId}/move(taskId=${task.id})}" class="btn btn-sm btn-warning">Mover</a>

        <!-- mostrar botão de bloquear ou desbloquear conforme estado -->
        <form th:if="${!task.blocked}" th:action="@{/boards/tasks/{taskId}/block(taskId=${task.id})}" method="post" style="display:inline-block;">
            <input type="hidden" name="reason" value="Bloqueado via UI">
            <button type="submit" class="btn btn-sm btn-danger">Bloquear</button>
        </form>

        <form th:if="${task.blocked}" th:action="@{/boards/tasks/{taskId}/unblock(taskId=${task.id})}" method="post" style="display:inline-block;">
            <input type="hidden" name="reason" value="Desbloqueado via UI">
            <button type="submit" class="btn btn-sm btn-success">Desbloquear</button>
        </form>

        <!-- link para o histórico -->
        <a th:href="@{/boards/tasks/{taskId}/history(taskId=${task.id})}" class="btn btn-sm btn-secondary">Histórico</a>
    </div>
</li>    


                        
                    </ul>
                </div>
            </div>
        </div>
    </div>

</body>
</html>
